---

title: Data


keywords: fastai
sidebar: home_sidebar

summary: "Prepare reaction yield data from different sources"
description: "Prepare reaction yield data from different sources"
nb_path: "nbs/01_data.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Buchwald-Hartwig-high-throughput-experiment-data-set">Buchwald-Hartwig high-throughput experiment data set<a class="anchor-link" href="#Buchwald-Hartwig-high-throughput-experiment-data-set"> </a></h3><p>For the Buchwald-Hartwig reactions we used the data set and splits as provided by</p>

<pre><code>Sandfort et al. "A structure-based platform for predicting chemical reactivity." Chem (2020).</code></pre>
<p>and originally published in</p>

<pre><code>Ahneman et al. "Predicting reaction performance in Câ€“N cross-coupling using machine learning." Science 360.6385 (2018): 186-190..</code></pre>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="canonicalize_with_dict" class="doc_header"><code>canonicalize_with_dict</code><a href="https://github.com/rxn4chemistry/rxn_yields/tree/master/rxn_yields/data.py#L10" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>canonicalize_with_dict</code>(<strong><code>smi</code></strong>, <strong><code>can_smi_dict</code></strong>=<em><code>{}</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_buchwald_hartwig_rxns" class="doc_header"><code>generate_buchwald_hartwig_rxns</code><a href="https://github.com/rxn4chemistry/rxn_yields/tree/master/rxn_yields/data.py#L16" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_buchwald_hartwig_rxns</code>(<strong><code>df</code></strong>)</p>
</blockquote>
<p>Converts the entries in the excel files from Sandfort et al. to reaction SMILES.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">expected_rxns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Clc1ccccn1.Cc1ccc(N)cc1.O=S(=O)(O[Pd]1c2ccccc2-c2ccccc2N~1)C(F)(F)F.COc1ccc(OC)c(P([C@]23C[C@H]4C[C@H](C[C@H](C4)C2)C3)[C@]23C[C@H]4C[C@H](C[C@H](C4)C2)C3)c1-c1c(C(C)C)cc(C(C)C)cc1C(C)C.CCN=P(N=P(N(C)C)(N(C)C)N(C)C)(N(C)C)N(C)C.Cc1cc(C)on1&gt;&gt;Cc1ccc(Nc2ccccn2)cc1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Brc1ccccn1.Cc1ccc(N)cc1.O=S(=O)(O[Pd]1c2ccccc2-c2ccccc2N~1)C(F)(F)F.COc1ccc(OC)c(P([C@]23C[C@H]4C[C@H](C[C@H](C4)C2)C3)[C@]23C[C@H]4C[C@H](C[C@H](C4)C2)C3)c1-c1c(C(C)C)cc(C(C)C)cc1C(C)C.CCN=P(N=P(N(C)C)(N(C)C)N(C)C)(N(C)C)N(C)C.COC(=O)c1ccno1&gt;&gt;Cc1ccc(Nc2ccccn2)cc1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CCc1ccc(I)cc1.Cc1ccc(N)cc1.O=S(=O)(O[Pd]1c2ccccc2-c2ccccc2N~1)C(F)(F)F.CC(C)c1cc(C(C)C)c(-c2ccccc2P(C2CCCCC2)C2CCCCC2)c(C(C)C)c1.CCN=P(N=P(N(C)C)(N(C)C)N(C)C)(N(C)C)N(C)C.COC(=O)c1ccno1&gt;&gt;CCc1ccc(Nc2ccc(C)cc2)cc1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;FC(F)(F)c1ccc(Cl)cc1.Cc1ccc(N)cc1.O=S(=O)(O[Pd]1c2ccccc2-c2ccccc2N~1)C(F)(F)F.COc1ccc(OC)c(P(C(C)(C)C)C(C)(C)C)c1-c1c(C(C)C)cc(C(C)C)cc1C(C)C.CN1CCCN2CCCN=C12.CCOC(=O)c1cnoc1&gt;&gt;Cc1ccc(Nc2ccc(C(F)(F)F)cc2)cc1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;COc1ccc(Cl)cc1.Cc1ccc(N)cc1.O=S(=O)(O[Pd]1c2ccccc2-c2ccccc2N~1)C(F)(F)F.COc1ccc(OC)c(P([C@]23C[C@H]4C[C@H](C[C@H](C4)C2)C3)[C@]23C[C@H]4C[C@H](C[C@H](C4)C2)C3)c1-c1c(C(C)C)cc(C(C)C)cc1C(C)C.CN1CCCN2CCCN=C12.Cc1cc(C)on1&gt;&gt;COc1ccc(Nc2ccc(C)cc2)cc1&#39;</span><span class="p">]</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Ligand&quot;</span><span class="p">:{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span><span class="s2">&quot;CC(C)C(C=C(C(C)C)C=C1C(C)C)=C1C2=C(P([C@@]3(C[C@@H]4C5)C[C@H](C4)C[C@H]5C3)[C@]6(C7)C[C@@H](C[C@@H]7C8)C[C@@H]8C6)C(OC)=CC=C2OC&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">:</span><span class="s2">&quot;CC(C)C(C=C(C(C)C)C=C1C(C)C)=C1C2=C(P([C@@]3(C[C@@H]4C5)C[C@H](C4)C[C@H]5C3)[C@]6(C7)C[C@@H](C[C@@H]7C8)C[C@@H]8C6)C(OC)=CC=C2OC&quot;</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">:</span><span class="s2">&quot;CC(C)C(C=C(C(C)C)C=C1C(C)C)=C1C2=C(P(C3CCCCC3)C4CCCCC4)C=CC=C2&quot;</span><span class="p">,</span><span class="s2">&quot;3&quot;</span><span class="p">:</span><span class="s2">&quot;CC(C)C(C=C(C(C)C)C=C1C(C)C)=C1C2=C(P(C(C)(C)C)C(C)(C)C)C(OC)=CC=C2OC&quot;</span><span class="p">,</span><span class="s2">&quot;4&quot;</span><span class="p">:</span><span class="s2">&quot;CC(C)C(C=C(C(C)C)C=C1C(C)C)=C1C2=C(P([C@@]3(C[C@@H]4C5)C[C@H](C4)C[C@H]5C3)[C@]6(C7)C[C@@H](C[C@@H]7C8)C[C@@H]8C6)C(OC)=CC=C2OC&quot;</span><span class="p">},</span><span class="s2">&quot;Additive&quot;</span><span class="p">:{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span><span class="s2">&quot;CC1=CC(C)=NO1&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">:</span><span class="s2">&quot;O=C(OC)C1=CC=NO1&quot;</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">:</span><span class="s2">&quot;O=C(OC)C1=CC=NO1&quot;</span><span class="p">,</span><span class="s2">&quot;3&quot;</span><span class="p">:</span><span class="s2">&quot;CCOC(C1=CON=C1)=O&quot;</span><span class="p">,</span><span class="s2">&quot;4&quot;</span><span class="p">:</span><span class="s2">&quot;CC1=CC(C)=NO1&quot;</span><span class="p">},</span><span class="s2">&quot;Base&quot;</span><span class="p">:{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span><span class="s2">&quot;CN(C)P(N(C)C)(N(C)C)=NP(N(C)C)(N(C)C)=NCC&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">:</span><span class="s2">&quot;CN(C)P(N(C)C)(N(C)C)=NP(N(C)C)(N(C)C)=NCC&quot;</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">:</span><span class="s2">&quot;CN(C)P(N(C)C)(N(C)C)=NP(N(C)C)(N(C)C)=NCC&quot;</span><span class="p">,</span><span class="s2">&quot;3&quot;</span><span class="p">:</span><span class="s2">&quot;CN1CCCN2C1=NCCC2&quot;</span><span class="p">,</span><span class="s2">&quot;4&quot;</span><span class="p">:</span><span class="s2">&quot;CN1CCCN2C1=NCCC2&quot;</span><span class="p">},</span><span class="s2">&quot;Aryl halide&quot;</span><span class="p">:{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span><span class="s2">&quot;ClC1=NC=CC=C1&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">:</span><span class="s2">&quot;BrC1=NC=CC=C1&quot;</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">:</span><span class="s2">&quot;IC1=CC=C(CC)C=C1&quot;</span><span class="p">,</span><span class="s2">&quot;3&quot;</span><span class="p">:</span><span class="s2">&quot;ClC1=CC=C(C(F)(F)F)C=C1&quot;</span><span class="p">,</span><span class="s2">&quot;4&quot;</span><span class="p">:</span><span class="s2">&quot;ClC1=CC=C(OC)C=C1&quot;</span><span class="p">},</span><span class="s2">&quot;Output&quot;</span><span class="p">:{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span><span class="mf">70.41045785</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">:</span><span class="mf">11.06445724</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">:</span><span class="mf">10.22354965</span><span class="p">,</span><span class="s2">&quot;3&quot;</span><span class="p">:</span><span class="mf">20.0833829</span><span class="p">,</span><span class="s2">&quot;4&quot;</span><span class="p">:</span><span class="mf">0.492662711</span><span class="p">}})</span>
<span class="n">converted_rxns</span> <span class="o">=</span> <span class="n">generate_buchwald_hartwig_rxns</span><span class="p">(</span><span class="n">test_df</span><span class="p">)</span>
<span class="k">for</span> <span class="n">rxn</span><span class="p">,</span> <span class="n">expected</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">converted_rxns</span><span class="p">,</span> <span class="n">expected_rxns</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">rxn</span> <span class="o">==</span> <span class="n">expected</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Suzuki-Miyaura-reaction-data-set">Suzuki-Miyaura reaction data set<a class="anchor-link" href="#Suzuki-Miyaura-reaction-data-set"> </a></h3><p>Originally published in</p>

<pre><code>Perera et al. "A platform for automated nanomole-scale reaction screening and micromole-scale synthesis in flow." Science 359.6374 (2018): 429-434.</code></pre>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;../data/Suzuki-Miyaura/aap9112_Data_File_S1.xlsx&#39;</span><span class="p">)</span>
<span class="n">reactant_1_smiles</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;6-chloroquinoline&#39;</span><span class="p">:</span> <span class="s1">&#39;C1=C(Cl)C=CC2=NC=CC=C12.CCC1=CC(=CC=C1)CC&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;6-Bromoquinoline&#39;</span><span class="p">:</span> <span class="s1">&#39;C1=C(Br)C=CC2=NC=CC=C12.CCC1=CC(=CC=C1)CC&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;6-triflatequinoline&#39;</span><span class="p">:</span> <span class="s1">&#39;C1C2C(=NC=CC=2)C=CC=1OS(C(F)(F)F)(=O)=O.CCC1=CC(=CC=C1)CC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;6-Iodoquinoline&#39;</span><span class="p">:</span> <span class="s1">&#39;C1=C(I)C=CC2=NC=CC=C12.CCC1=CC(=CC=C1)CC&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;6-quinoline-boronic acid hydrochloride&#39;</span><span class="p">:</span> <span class="s1">&#39;C1C(B(O)O)=CC=C2N=CC=CC=12.Cl.O&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Potassium quinoline-6-trifluoroborate&#39;</span><span class="p">:</span> <span class="s1">&#39;[B-](C1=CC2=C(C=C1)N=CC=C2)(F)(F)F.[K+].O&#39;</span><span class="p">,</span>
    <span class="s1">&#39;6-Quinolineboronic acid pinacol ester&#39;</span><span class="p">:</span> <span class="s1">&#39;B1(OC(C(O1)(C)C)(C)C)C2=CC3=C(C=C2)N=CC=C3.O&#39;</span>
<span class="p">}</span>

<span class="n">reactant_2_smiles</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;2a, Boronic Acid&#39;</span><span class="p">:</span> <span class="s1">&#39;CC1=CC=C2C(C=NN2C3OCCCC3)=C1B(O)O&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;2b, Boronic Ester&#39;</span><span class="p">:</span> <span class="s1">&#39;CC1=CC=C2C(C=NN2C3OCCCC3)=C1B4OC(C)(C)C(C)(C)O4&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;2c, Trifluoroborate&#39;</span><span class="p">:</span> <span class="s1">&#39;CC1=CC=C2C(C=NN2C3OCCCC3)=C1[B-](F)(F)F.[K+]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;2d, Bromide&#39;</span><span class="p">:</span> <span class="s1">&#39;CC1=CC=C2C(C=NN2C3OCCCC3)=C1Br&#39;</span> 
<span class="p">}</span>

<span class="n">catalyst_smiles</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Pd(OAc)2&#39;</span><span class="p">:</span> <span class="s1">&#39;CC(=O)O~CC(=O)O~[Pd]&#39;</span>
<span class="p">}</span>

<span class="n">ligand_smiles</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;P(tBu)3&#39;</span><span class="p">:</span> <span class="s1">&#39;CC(C)(C)P(C(C)(C)C)C(C)(C)C&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;P(Ph)3 &#39;</span><span class="p">:</span> <span class="s1">&#39;c3c(P(c1ccccc1)c2ccccc2)cccc3&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;AmPhos&#39;</span><span class="p">:</span> <span class="s1">&#39;CC(C)(C)P(C1=CC=C(C=C1)N(C)C)C(C)(C)C&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;P(Cy)3&#39;</span><span class="p">:</span> <span class="s1">&#39;C1(CCCCC1)P(C2CCCCC2)C3CCCCC3&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;P(o-Tol)3&#39;</span><span class="p">:</span> <span class="s1">&#39;CC1=CC=CC=C1P(C2=CC=CC=C2C)C3=CC=CC=C3C&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CataCXium A&#39;</span><span class="p">:</span> <span class="s1">&#39;CCCCP(C12CC3CC(C1)CC(C3)C2)C45CC6CC(C4)CC(C6)C5&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;SPhos&#39;</span><span class="p">:</span> <span class="s1">&#39;COc1cccc(c1c2ccccc2P(C3CCCCC3)C4CCCCC4)OC&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;dtbpf&#39;</span><span class="p">:</span> <span class="s1">&#39;CC(C)(C)P(C1=CC=C[CH]1)C(C)(C)C.CC(C)(C)P(C1=CC=C[CH]1)C(C)(C)C.[Fe]&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;XPhos&#39;</span><span class="p">:</span> <span class="s1">&#39;P(c2ccccc2c1c(cc(cc1C(C)C)C(C)C)C(C)C)(C3CCCCC3)C4CCCCC4&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;dppf&#39;</span><span class="p">:</span> <span class="s1">&#39;C1=CC=C(C=C1)P([C-]2C=CC=C2)C3=CC=CC=C3.C1=CC=C(C=C1)P([C-]2C=CC=C2)C3=CC=CC=C3.[Fe+2]&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Xantphos&#39;</span><span class="p">:</span> <span class="s1">&#39;O6c1c(cccc1P(c2ccccc2)c3ccccc3)C(c7cccc(P(c4ccccc4)c5ccccc5)c67)(C)C&#39;</span><span class="p">,</span>
    <span class="s1">&#39;None&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span>
<span class="p">}</span>

<span class="n">reagent_1_smiles</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;NaOH&#39;</span><span class="p">:</span> <span class="s1">&#39;[OH-].[Na+]&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;NaHCO3&#39;</span><span class="p">:</span> <span class="s1">&#39;[Na+].OC([O-])=O&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;CsF&#39;</span><span class="p">:</span> <span class="s1">&#39;[F-].[Cs+]&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;K3PO4&#39;</span><span class="p">:</span> <span class="s1">&#39;[K+].[K+].[K+].[O-]P([O-])([O-])=O&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;KOH&#39;</span><span class="p">:</span> <span class="s1">&#39;[K+].[OH-]&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;LiOtBu&#39;</span><span class="p">:</span> <span class="s1">&#39;[Li+].[O-]C(C)(C)C&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Et3N&#39;</span><span class="p">:</span> <span class="s1">&#39;CCN(CC)CC&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;None&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span>
<span class="p">}</span>

<span class="n">solvent_1_smiles</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;MeCN&#39;</span><span class="p">:</span> <span class="s1">&#39;CC#N.O&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;THF&#39;</span><span class="p">:</span> <span class="s1">&#39;C1CCOC1.O&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;DMF&#39;</span><span class="p">:</span> <span class="s1">&#39;CN(C)C=O.O&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;MeOH&#39;</span><span class="p">:</span> <span class="s1">&#39;CO.O&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;MeOH/H2O_V2 9:1&#39;</span><span class="p">:</span> <span class="s1">&#39;CO.O&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;THF_V2&#39;</span><span class="p">:</span> <span class="s1">&#39;C1CCOC1.O&#39;</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">make_reaction_smiles</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">precursors</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">reactant_1_smiles</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Reactant_1_Name&#39;</span><span class="p">]]</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">reactant_2_smiles</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Reactant_2_Name&#39;</span><span class="p">]]</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">catalyst_smiles</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Catalyst_1_Short_Hand&#39;</span><span class="p">]]</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">ligand_smiles</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Ligand_Short_Hand&#39;</span><span class="p">]]</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">reagent_1_smiles</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Reagent_1_Short_Hand&#39;</span><span class="p">]]</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">solvent_1_smiles</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Solvent_1_Short_Hand&#39;</span><span class="p">]]</span><span class="si">}</span><span class="s2"> &quot;</span>
    <span class="n">product</span> <span class="o">=</span> <span class="s1">&#39;C1=C(C2=C(C)C=CC3N(C4OCCCC4)N=CC2=3)C=CC2=NC=CC=C12&#39;</span>
<span class="c1">#     print(precursors, product)</span>
    <span class="n">can_precursors</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">precursors</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; .&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;. &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)))</span>
    <span class="n">can_product</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">product</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">can_precursors</span><span class="si">}</span><span class="s2">&gt;&gt;</span><span class="si">{</span><span class="n">can_product</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Random-splits">Random splits<a class="anchor-link" href="#Random-splits"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rxn&#39;</span><span class="p">]</span><span class="o">=</span> <span class="p">[</span><span class="n">make_reaction_smiles</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Product_Yield_PCT_Area_UV&#39;</span><span class="p">]</span><span class="o">/</span> <span class="mf">100.</span>
<span class="n">reactions_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;rxn&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]]</span>

<span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">new_df</span> <span class="o">=</span> <span class="n">reactions_df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">)[[</span><span class="s1">&#39;rxn&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]]</span>
    <span class="n">new_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;../data/Suzuki-Miyaura/random_splits/random_split_</span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s1">.tsv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">new_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>                                                   rxn         y
464  Brc1ccc2ncccc2c1.CC#N.CC(=O)O~CC(=O)O~[Pd].CC(...  0.643011
98   C1CCOC1.CC(=O)O~CC(=O)O~[Pd].CCc1cccc(CC)c1.CN...  0.612001
                                                    rxn         y
473   Brc1ccc2ncccc2c1.CC#N.CC(=O)O~CC(=O)O~[Pd].CCC...  0.918077
5519  CC#N.CC(=O)O~CC(=O)O~[Pd].CC(C)(C)[O-].CC1(C)O...  0.513346
                                                    rxn         y
4944  CC(=O)O~CC(=O)O~[Pd].CC(C)(C)P(C(C)(C)C)C(C)(C...  0.233489
3927  Brc1ccc2ncccc2c1.CC#N.CC(=O)O~CC(=O)O~[Pd].CCc...  0.178764
                                                   rxn         y
914  C1CCOC1.CC(=O)O~CC(=O)O~[Pd].CCc1cccc(CC)c1.CN...  0.114641
940  C1CCOC1.CC(=O)O~CC(=O)O~[Pd].CCN(CC)CC.CCc1ccc...  0.540637
                                                    rxn         y
3896  Brc1ccc2ncccc2c1.CC#N.CC(=O)O~CC(=O)O~[Pd].CC(...  0.134639
1991  CC#N.CC(=O)O~CC(=O)O~[Pd].CC(C)(C)[O-].CCc1ccc...  0.654905
                                                    rxn         y
1872  CC(=O)O~CC(=O)O~[Pd].CC(C)(C)P(C(C)(C)C)C(C)(C...  0.193283
1879  CC(=O)O~CC(=O)O~[Pd].CC(C)(C)P(C1=CC=C[CH]1)C(...  0.503925
                                                    rxn         y
5207  C1CCOC1.CC(=O)O~CC(=O)O~[Pd].Cc1ccc2c(cnn2C2CC...  0.288076
2444  Brc1ccc2ncccc2c1.C1CCOC1.CC(=O)O~CC(=O)O~[Pd]....  0.412966
                                                    rxn         y
5759  CC(=O)O~CC(=O)O~[Pd].CC1(C)OB(c2ccc3ncccc3c2)O...  0.541974
651   Brc1ccc2ncccc2c1.C1CCC(P(C2CCCCC2)C2CCCCC2)CC1...  0.382453
                                                    rxn         y
1133  CC(=O)O~CC(=O)O~[Pd].CCCCP(C12CC3CC(CC(C3)C1)C...  0.808541
4835  C1CCOC1.CC(=O)O~CC(=O)O~[Pd].Cc1ccc2c(cnn2C2CC...  0.349989
                                                    rxn         y
1412  CC(=O)O~CC(=O)O~[Pd].CC(C)(C)[O-].CC(C)c1cc(C(...  0.752941
886   C1CCOC1.CC(=O)O~CC(=O)O~[Pd].CC1(C)c2cccc(P(c3...  0.082582
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

